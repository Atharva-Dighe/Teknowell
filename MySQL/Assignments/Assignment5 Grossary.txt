Assignment 5 Grossary Table -




------------------------------------------------------------------------------------------------------------------------------------------------------

Q.1. Display details of those item whose sell is max.

  mysql> select itemName,sum(qty)as total_qty from grossary group by itemName having sum(qty)=(select max(total_qty) from (select itemName,sum(qty)as total_qty from grossary group by itemName)as max_qty);
+----------+-----------+
| itemName | total_qty |
+----------+-----------+
| Cola     |      3000 |
+----------+-----------+
1 row in set (0.00 sec)


---------------------------------------------------------------------------------------------------------------------------------------------------------

Q.2. Display details of those whose occurance greater. 


--------------------------------------------------------------------------------------------------------------------------------------------------------

Q.3. Display last 5 records of items. 

mysql> select * from grossary limit 5 offset 25;
+----+-----------+------+------------+------+-----------+------------+
| id | itemName  | mrp  | retailCost | qty  | totalCost | sellDate   |
+----+-----------+------+------------+------+-----------+------------+
| 26 | Cola      |   35 |         30 | 3000 |     90000 | 2025-08-23 |
| 27 | Chips     |   20 |         15 | 2500 |     37500 | 2025-08-24 |
| 28 | Ice Cream |   80 |         75 | 1300 |     97500 | 2025-08-25 |
| 29 | Noodles   |   50 |         45 | 1600 |     72000 | 2025-08-01 |
| 30 | Coffee    |  400 |        390 |  300 |    117000 | 2025-08-04 |
+----+-----------+------+------------+------+-----------+------------+
5 rows in set (0.00 sec)

OR 

mysql> select * from grossary limit 25,5;
+----+-----------+------+------------+------+-----------+------------+
| id | itemName  | mrp  | retailCost | qty  | totalCost | sellDate   |
+----+-----------+------+------------+------+-----------+------------+
| 26 | Cola      |   35 |         30 | 3000 |     90000 | 2025-08-23 |
| 27 | Chips     |   20 |         15 | 2500 |     37500 | 2025-08-24 |
| 28 | Ice Cream |   80 |         75 | 1300 |     97500 | 2025-08-25 |
| 29 | Noodles   |   50 |         45 | 1600 |     72000 | 2025-08-01 |
| 30 | Coffee    |  400 |        390 |  300 |    117000 | 2025-08-04 |
+----+-----------+------+------------+------+-----------+------------+
5 rows in set (0.00 sec)

OR 

mysql> select * from grossary order by id desc limit 5;
+----+-----------+------+------------+------+-----------+------------+
| id | itemName  | mrp  | retailCost | qty  | totalCost | sellDate   |
+----+-----------+------+------------+------+-----------+------------+
| 30 | Coffee    |  400 |        390 |  300 |    117000 | 2025-08-04 |
| 29 | Noodles   |   50 |         45 | 1600 |     72000 | 2025-08-01 |
| 28 | Ice Cream |   80 |         75 | 1300 |     97500 | 2025-08-25 |
| 27 | Chips     |   20 |         15 | 2500 |     37500 | 2025-08-24 |
| 26 | Cola      |   35 |         30 | 3000 |     90000 | 2025-08-23 |
+----+-----------+------+------------+------+-----------+------------+
5 rows in set (0.00 sec)

-----------------------------------------------------------------------------------------------------------------------------

Q.4. Display last selling item details.

mysql> select * from grossary order by sellDate desc limit 1;
+----+----------+------+------------+------+-----------+------------+
| id | itemName | mrp  | retailCost | qty  | totalCost | sellDate   |
+----+----------+------+------------+------+-----------+------------+
| 20 | Eggs     |    7 |          6 | 2000 |     12000 | 2025-08-30 |
+----+----------+------+------------+------+-----------+------------+
1 row in set (0.00 sec)

-----------------------------------------------------------------------------------------------------------------------------------

Q.5. Display date wise items with its cost.(duplicate query)

mysql> select * from grossary where sellDate in (select sellDate from grossary group by sellDate)order by sellDate;
+----+------------+------+------------+------+-----------+------------+
| id | itemName   | mrp  | retailCost | qty  | totalCost | sellDate   |
+----+------------+------+------------+------+-----------+------------+
| 29 | Noodles    |   50 |         45 | 1600 |     72000 | 2025-08-01 |
|  1 | Wheat      |   60 |         55 | 1200 |     66000 | 2025-08-02 |
|  2 | Rice       |   80 |         75 |  900 |     67500 | 2025-08-03 |
| 30 | Coffee     |  400 |        390 |  300 |    117000 | 2025-08-04 |
|  3 | Sugar      |   45 |         42 | 1500 |     63000 | 2025-08-05 |
|  4 | Salt       |   20 |         18 |  800 |     14400 | 2025-08-06 |
|  5 | Oil        |  160 |        150 |  500 |     75000 | 2025-08-07 |
|  6 | Dry Fruits |  900 |        850 |   50 |     42500 | 2025-08-08 |
|  7 | Ghee       |  500 |        480 |  200 |     96000 | 2025-08-09 |
|  8 | Biscuits   |   30 |         25 | 1000 |     25000 | 2025-08-10 |
|  9 | Juice      |  120 |        110 |  300 |     33000 | 2025-08-11 |
| 10 | Tea        |  250 |        240 |  400 |     96000 | 2025-08-12 |
| 11 | Toothpaste |   45 |         40 |  200 |      8000 | 2025-08-13 |
| 12 | Soap       |   25 |         20 |  700 |     14000 | 2025-08-14 |
| 13 | Shampoo    |   90 |         85 |  350 |     29750 | 2025-08-15 |
| 14 | Detergent  |   70 |         65 |  600 |     39000 | 2025-08-16 |
| 15 | Butter     |  220 |        210 |  150 |     31500 | 2025-08-17 |
| 21 | Wheat      |   60 |         55 | 1100 |     60500 | 2025-08-18 |
| 22 | Rice       |   80 |         75 |  950 |     71250 | 2025-08-19 |
| 23 | Sugar      |   45 |         42 | 1400 |     58800 | 2025-08-20 |
| 24 | Oil        |  160 |        150 |  450 |     67500 | 2025-08-21 |
| 25 | Tea        |  250 |        240 |  380 |     91200 | 2025-08-22 |
| 26 | Cola       |   35 |         30 | 3000 |     90000 | 2025-08-23 |
| 27 | Chips      |   20 |         15 | 2500 |     37500 | 2025-08-24 |
| 28 | Ice Cream  |   80 |         75 | 1300 |     97500 | 2025-08-25 |
| 16 | Milk       |   60 |         55 | 1000 |     55000 | 2025-08-26 |
| 17 | Paneer     |  320 |        310 |  250 |     77500 | 2025-08-27 |
| 18 | Curd       |   90 |         85 |  400 |     34000 | 2025-08-28 |
| 19 | Cheese     |  350 |        340 |  180 |     61200 | 2025-08-29 |
| 20 | Eggs       |    7 |          6 | 2000 |     12000 | 2025-08-30 |
+----+------------+------+------------+------+-----------+------------+
30 rows in set (0.00 sec)

-----------------------------------------------------------------------------------------------------------------------------------

Q.6. Display highest sell items details. 

mysql> select * from grossary where itemName in(select itemName from grossary group by itemName having sum(qty)>= all(select sum(qty) from grossary group by itemName));
+----+----------+------+------------+------+-----------+------------+
| id | itemName | mrp  | retailCost | qty  | totalCost | sellDate   |
+----+----------+------+------------+------+-----------+------------+
| 26 | Cola     |   35 |         30 | 3000 |     90000 | 2025-08-23 |
+----+----------+------+------------+------+-----------+------------+
1 row in set (0.00 sec)

---------------------------------------------------------------------------------------------------------------------------------------------------------------------

Q.7. Which product gives maximum income display it. 

mysql> select distinct itemName,sum(totalCost) from grossary group by itemName having itemName in(select itemName from grossary group by itemName having sum(totalCost)>=all(select sum(totalCost) from grossary group by itemName));
+----------+----------------+
| itemName | sum(totalCost) |
+----------+----------------+
| Tea      |         187200 |
+----------+----------------+
1 row in set (0.00 sec)


-----------------------------------------------------------------------------------------------------------------------------------------------------------

Q.8. Add 2% gst to all goods.

FIRST ADD COLUMN gst

mysql> alter table grossary add column gstPrice int;
Query OK, 0 rows affected (0.21 sec)
Records: 0  Duplicates: 0  Warnings: 0

THEN UPDATE VALUES 

mysql> update grossary set gstPrice=totalCost+totalCost*2/100;
Query OK, 30 rows affected (0.08 sec)
Rows matched: 30  Changed: 30  Warnings: 0

mysql> select * from grossary;
+----+------------+------+------------+------+-----------+------------+----------+
| id | itemName   | mrp  | retailCost | qty  | totalCost | sellDate   | gstPrice |
+----+------------+------+------------+------+-----------+------------+----------+
|  1 | Wheat      |   60 |         55 | 1200 |     66000 | 2025-08-02 |    67320 |
|  2 | Rice       |   80 |         75 |  900 |     67500 | 2025-08-03 |    68850 |
|  3 | Sugar      |   45 |         42 | 1500 |     63000 | 2025-08-05 |    64260 |
|  4 | Salt       |   20 |         18 |  800 |     14400 | 2025-08-06 |    14688 |
|  5 | Oil        |  160 |        150 |  500 |     75000 | 2025-08-07 |    76500 |
|  6 | Dry Fruits |  900 |        850 |   50 |     42500 | 2025-08-08 |    43350 |
|  7 | Ghee       |  500 |        480 |  200 |     96000 | 2025-08-09 |    97920 |
|  8 | Biscuits   |   30 |         25 | 1000 |     25000 | 2025-08-10 |    25500 |
|  9 | Juice      |  120 |        110 |  300 |     33000 | 2025-08-11 |    33660 |
| 10 | Tea        |  250 |        240 |  400 |     96000 | 2025-08-12 |    97920 |
| 11 | Toothpaste |   45 |         40 |  200 |      8000 | 2025-08-13 |     8160 |
| 12 | Soap       |   25 |         20 |  700 |     14000 | 2025-08-14 |    14280 |
| 13 | Shampoo    |   90 |         85 |  350 |     29750 | 2025-08-15 |    30345 |
| 14 | Detergent  |   70 |         65 |  600 |     39000 | 2025-08-16 |    39780 |
| 15 | Butter     |  220 |        210 |  150 |     31500 | 2025-08-17 |    32130 |
| 16 | Milk       |   60 |         55 | 1000 |     55000 | 2025-08-26 |    56100 |
| 17 | Paneer     |  320 |        310 |  250 |     77500 | 2025-08-27 |    79050 |
| 18 | Curd       |   90 |         85 |  400 |     34000 | 2025-08-28 |    34680 |
| 19 | Cheese     |  350 |        340 |  180 |     61200 | 2025-08-29 |    62424 |
| 20 | Eggs       |    7 |          6 | 2000 |     12000 | 2025-08-30 |    12240 |
| 21 | Wheat      |   60 |         55 | 1100 |     60500 | 2025-08-18 |    61710 |
| 22 | Rice       |   80 |         75 |  950 |     71250 | 2025-08-19 |    72675 |
| 23 | Sugar      |   45 |         42 | 1400 |     58800 | 2025-08-20 |    59976 |
| 24 | Oil        |  160 |        150 |  450 |     67500 | 2025-08-21 |    68850 |
| 25 | Tea        |  250 |        240 |  380 |     91200 | 2025-08-22 |    93024 |
| 26 | Cola       |   35 |         30 | 3000 |     90000 | 2025-08-23 |    91800 |
| 27 | Chips      |   20 |         15 | 2500 |     37500 | 2025-08-24 |    38250 |
| 28 | Ice Cream  |   80 |         75 | 1300 |     97500 | 2025-08-25 |    99450 |
| 29 | Noodles    |   50 |         45 | 1600 |     72000 | 2025-08-01 |    73440 |
| 30 | Coffee     |  400 |        390 |  300 |    117000 | 2025-08-04 |   119340 |
+----+------------+------+------------+------+-----------+------------+----------+
30 rows in set (0.00 sec)

------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
Q.9.  Find out details of those which are sold after 25th date. 

mysql> select * from grossary where day(sellDate)> 25;
+----+----------+------+------------+------+-----------+------------+----------+
| id | itemName | mrp  | retailCost | qty  | totalCost | sellDate   | gstPrice |
+----+----------+------+------------+------+-----------+------------+----------+
| 16 | Milk     |   60 |         55 | 1000 |     55000 | 2025-08-26 |    56100 |
| 17 | Paneer   |  320 |        310 |  250 |     77500 | 2025-08-27 |    79050 |
| 18 | Curd     |   90 |         85 |  400 |     34000 | 2025-08-28 |    34680 |
| 19 | Cheese   |  350 |        340 |  180 |     61200 | 2025-08-29 |    62424 |
| 20 | Eggs     |    7 |          6 | 2000 |     12000 | 2025-08-30 |    12240 |
+----+----------+------+------------+------+-----------+------------+----------+
5 rows in set (0.05 sec)

------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------

Q.10. Display details of those items which sold in first 10 days. 




